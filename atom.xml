<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Civinx]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://yoursite.com/"/>
  <updated>2017-01-04T07:58:48.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name><![CDATA[Civinx]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[ACM实验室招新启事]]></title>
    <link href="http://yoursite.com/2017/01/04/readme(final_report)/"/>
    <id>http://yoursite.com/2017/01/04/readme(final_report)/</id>
    <published>2017-01-04T07:47:59.000Z</published>
    <updated>2017-01-04T07:58:48.000Z</updated>
    <content type="html"><![CDATA[<h4 id="Python3实现简易的markdown解释器">Python3实现简易的markdown解释器</h4><a id="more"></a>
<p>#2016-2017学年第1学期</p>
<p>##实验报告</p>
<ul>
<li>课程名称:Python 程序设计基础</li>
<li>实验项目:大作业</li>
<li>专业班级:软件工程1501</li>
<li>学生学号:31501293</li>
<li>学生姓名:陈哲凡</li>
<li>实验指导教室:郭鸣, 李飞</li>
</ul>
<h2 id=""><img src="http://oj8wl05o7.bkt.clouddn.com/4.png" alt=""></h2><h1 id="Python3实现简易的markdown解释器-1">Python3实现简易的markdown解释器</h1><h2 id="一、介绍(说明文档)">一、介绍(说明文档)</h2><p>该简易的 markdown 解释器最终是一个.py文件，能在shall中通过命令将一个 markdown 文件转换成 HTML 和 PDF 文件（之所以称为简易是因为只支持部分语法，支持的语法将会在之后列出）。其原理是借助 docopt 进行命令行解析，随后逐行借助 re 匹配特定的 markdown 语法，向目标文件中添加入对应的 HTML 标签，最后借助 wkhtmltopdf 工具将 HTML 文件转换成 PDF 文件。</p>
<h3 id="1-_使用前的准备">1. 使用前的准备</h3><p>由于本解释器使用了 wkhtmltopdf 工具，以及第三方库 docopt，所以在使用前，你需要安装它们，在此给出它们的官方网站。</p>
<ul>
<li>wkhtmltopdf: <a href="http://wkhtmltopdf.org/index.html" target="_blank" rel="external">http://wkhtmltopdf.org/index.html</a></li>
<li>docopt: <a href="http://docopt.org/" target="_blank" rel="external">http://docopt.org</a></li>
</ul>
<h3 id="2-_支持的语法">2. 支持的语法</h3><h4 id="1-标题">1.标题</h4><p>标题前使用 # ，例如下述代码块：</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># 一级标题</span></span><br><span class="line"><span class="preprocessor">## 二级标题</span></span><br><span class="line"><span class="preprocessor">### 三级标题</span></span><br><span class="line"><span class="preprocessor">#### 四级标题</span></span><br></pre></td></tr></table></figure>
<h4 id="2-列表">2.列表</h4><p>有序列表前使用数字 1.  ， 2.  等，例如：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> item1</span><br><span class="line"><span class="number">2.</span> item2</span><br><span class="line"><span class="number">3.</span> item3</span><br></pre></td></tr></table></figure>
<ol>
<li>item1</li>
<li>item2</li>
<li>item3</li>
</ol>
<p>无序列表前面加 -，*或者+ ，例如：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>itemx</span><br><span class="line"><span class="bullet">+ </span>itemy</span><br><span class="line"><span class="bullet">- </span>itemz</span><br></pre></td></tr></table></figure>
<ul>
<li>itemx</li>
</ul>
<ul>
<li>itemy</li>
</ul>
<ul>
<li>itemz</li>
</ul>
<p>####3.代码块</p>
<p>在代码的上下分别用\<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;</span><br></pre></td></tr></table></figure></p>
<p>a = b + c<br>print (a)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="preprocessor">#### <span class="number">4.</span> 链接和图片</span></span><br></pre></td></tr></table></figure></p>
<p>[现实文本](网址)<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">插入链接的样式为[<span class="link_label">显示文本</span>](<span class="link_url">链接地址</span>)</span><br><span class="line"></span><br><span class="line"><span class="header">#### 5. 引用</span></span><br><span class="line"></span><br><span class="line">使用 &gt; 表示后续文字为引用，例如</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>引用文字<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="blockquote">&gt; 引用文字</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="header">#### 6. 粗体和斜体</span></span><br><span class="line"></span><br><span class="line">用两个 <span class="bullet">* 包含一段文本就是粗体的语法，用一个 *</span> 包含一段文本就是斜体</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>粗体文字</strong></p>
<p><em>斜体文字</em><br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">*</span><span class="keyword">*</span>粗体文字<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">*</span>斜体文字<span class="keyword">*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#### 7. 分割线</span></span><br><span class="line">大于等于三个连续的 -</span><br></pre></td></tr></table></figure></p>
<h2 id="abc">abc</h2><p>345<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="header">abc</span><br><span class="line">---</span></span><br><span class="line">345</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 3. 使用说明</span><br></pre></td></tr></table></figure></p>
<p>$ python3 md2pdf.py 原文件名 参数 目标文件名<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<pre><code>-<span class="ruby">h --help     显示帮助文档
</span>-<span class="ruby">v --version  显示版本
</span>-<span class="ruby">o --output   只生成 <span class="constant">HTML</span> 文件
</span>-<span class="ruby">p --print    分别生成 <span class="constant">HTML</span> 文件和 <span class="constant">PDF</span> 文件
</span>-<span class="ruby"><span class="constant">P</span> --<span class="constant">Print</span>    只生成 <span class="constant">PDF</span> 文件</span>
</code></pre><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">例：</span><br></pre></td></tr></table></figure>
<p>$ python3 md2pdf.py test1.md -p test2.pdf<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">生成一个 test2.pdf 文件和一个 translation_result.html 文件</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">## 二、代码分析</span></span><br><span class="line"><span class="preprocessor">###1. docopt文档</span></span><br></pre></td></tr></table></figure></p>
<p>“””md2pdf</p>
<p>translates markdwon file into html or pdf, and support picture insertion.</p>
<p>Usage:<br>    md2pdf <sourcefile> <outputfile> [options]</outputfile></sourcefile></p>
<p>Options:<br>    -h –help     show help document.<br>    -v –version  show version information.<br>    -o –output   translate sourcefile into html file.<br>    -p –print    translate sourcefile into pdf file and html file respectively.<br>    -P –Print    translate sourcefile into pdf file only.<br>“””<br><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">这部分在接下来会作为 <span class="escape">``</span><span class="escape">`_</span>_doc__<span class="escape">``</span><span class="escape">` </span>来初始化 docopt </span><br><span class="line"></span><br><span class="line">docopt 会自动对其做命令行解释，这个过程不用我们来操心，十分方便</span><br><span class="line"></span><br><span class="line">###<span class="number">2</span>. 需要导入的库和全局状态</span><br></pre></td></tr></table></figure></p>
<p>import os,re<br>import sys,getopt<br>from enum import Enum<br>from subprocess import call<br>from functools import reduce</p>
<p>from docopt import docopt</p>
<p><strong>version</strong> = ‘1.0’</p>
<h1 id="有序序列状态">有序序列状态</h1><p>class ORDERLIST(Enum):<br>    Init = 1<br>    List = 2</p>
<h1 id="块状态">块状态</h1><p>class BLOCK(Enum):<br>    Init = 1<br>    Block = 2<br>    CodeBlock = 3</p>
<h1 id="定义全局状态，并初始化状态">定义全局状态，并初始化状态</h1><h1 id="table_state_=_TABLE-Init">table_state = TABLE.Init</h1><p>orderList_state = ORDERLIST.Init<br>block_state = BLOCK.Init<br>is_code = False<br>is_normal = True<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这些全局变量帮程序来表示当前文本的状态，比如是否为代码块的开头、中间、结尾，以此来加入合适的 HTML 标签</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">###<span class="number">3.</span> 主函数</span></span><br></pre></td></tr></table></figure></p>
<p>def main():<br>    dest_file = “translation_result.html”<br>    dest_pdf_file = “translation_result.pdf”</p>
<pre><code>only_pdf = False

<span class="keyword">args</span> = docopt(__doc__, <span class="keyword">version</span>=__version__)

#只要HTML，如果参数是-<span class="keyword">P</span>，即HTML和PDF都要生成，HTML采用默认文件名
dest_file = <span class="keyword">args</span>[<span class="string">'&lt;outputfile&gt;'</span>] <span class="keyword">if</span> <span class="keyword">args</span>[<span class="string">'--output'</span>] <span class="keyword">else</span> dest_file

#需要生成PDF
dest_pdf_file = <span class="keyword">args</span>[<span class="string">'&lt;outputfile&gt;'</span>] <span class="keyword">if</span> <span class="keyword">args</span>[<span class="string">'--print'</span>] <span class="built_in">or</span> <span class="keyword">args</span>[<span class="string">'--Print'</span>] <span class="keyword">else</span> <span class="string">""</span>


run(<span class="keyword">args</span>[<span class="string">'&lt;sourcefile&gt;'</span>], dest_file, dest_pdf_file, <span class="keyword">args</span>[<span class="string">'--Print'</span>])
</code></pre><p>if <strong>name</strong>==”<strong>main</strong>“:<br>    main() </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">其中args是docopt返回的一个字典，其key和value是根据我们在开头写的注释来生成的，如args[‘\&lt;sourcefile&gt;’]就会返回用户在命令行输入的原文件名。</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">###<span class="number">4.</span> 执行函数</span></span><br></pre></td></tr></table></figure>
<p>def run(source_file, dest_file, dest_pdf_file, only_pdf):</p>
<pre><code># 获取文件名
file_name = source_file
# 转换后的 HTML 文件名
dest_name = dest_file
# 转换后的 PDF 文件名
dest_pdf_name = dest_pdf_file

# 获取文件后缀
_, suffix = os.path.splitext(file_name)
if suffix not in [".md",".markdown",".mdown","mkd"]:
    print('Error: the file should be in markdown format')
    sys.exit(1)

if only_pdf:
    dest_name = ".~temp~.html"


f = open(file_name, "r")
f_r = open(dest_name, "w")

# 往文件中填写 HTML 的一些属性
f_r.write("""<span class="tag">&lt;<span class="title">style</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>&gt;</span><span class="css"><span class="tag">div</span> <span class="rules">{<span class="rule"><span class="attribute">display</span>:<span class="value"> block</span></span>;<span class="rule"><span class="attribute">font-family</span>:<span class="value"> <span class="string">"Times New Roman"</span>,Georgia,Serif</span></span></span>}\
        <span class="id">#wrapper</span> <span class="rules">{ <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100%</span></span></span>;<span class="rule"><span class="attribute">height</span>:<span class="value"><span class="number">100%</span></span></span>; <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">0</span></span></span>;}</span><span class="id">#left</span> <span class="rules">{ <span class="rule"><span class="attribute">float</span>:<span class="value">left</span></span>; \
        <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">10%</span></span></span>;  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100%</span></span></span>;  }</span><span class="id">#second</span> <span class="rules">{   <span class="rule"><span class="attribute">float</span>:<span class="value">left</span></span>;   <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">80%</span></span></span>;<span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100%</span></span></span>;   \
        }</span><span class="id">#right</span> <span class="rules">{<span class="rule"><span class="attribute">float</span>:<span class="value">left</span></span>;  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">10%</span></span></span>;  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100%</span></span></span>; \
        }</span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"wrapper"</span>&gt;</span> <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"left"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"second"</span>&gt;</span>""")
f_r.write("""<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>/&gt;</span>""")

# 逐行解析 markdwon 文件
for eachline in f:
    result = parse(eachline)
    if result != "":
        f_r.write(result)

f_r.write("""<span class="tag">&lt;<span class="title">br</span> /&gt;</span><span class="tag">&lt;<span class="title">br</span> /&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"right"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>""")

f_r.close()
f.close()

# 调用扩展 wkhtmltopdf 将 HTML 文件转换成 PDF
if dest_pdf_name != "" or only_pdf:
    call(["wkhtmltopdf", dest_name, dest_pdf_name])
# 如果有必要，删除中间过程生成的 HTML 文件
if only_pdf:
    call(["rm", dest_name])
</code></pre><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="preprocessor">###<span class="number">5.</span> 转换函数</span></span><br></pre></td></tr></table></figure>
<p>def parse(input):<br>    global block_state, is_normal<br>    is_normal = True<br>    result = input</p>
<pre><code><span class="comment"># 检测当前 input 解析状态</span>
<span class="literal">result</span> = test_state(input)

<span class="comment">#如果是代码块，那再test_state中已经处理完了，直接返回</span>
<span class="keyword">if</span> block_state == <span class="type">BLOCK</span>.<span class="type">Block</span>:
    <span class="keyword">return</span> <span class="literal">result</span>

<span class="comment"># 分析标题标记 </span>
title_rank = <span class="number">0</span>
<span class="keyword">for</span> i <span class="keyword">in</span> <span class="type">range</span>(<span class="number">6</span>, <span class="number">0</span>, -<span class="number">1</span>):
    <span class="keyword">if</span> input[:i] == '<span class="comment">#'*i:</span>
        title_rank = i
        <span class="keyword">break</span>
<span class="keyword">if</span> title_rank != <span class="number">0</span>:
    <span class="comment"># 处理标题，转化为相应的 HTML 文本</span>
    <span class="literal">result</span> = handleTitle(input, title_rank)
    <span class="keyword">return</span> <span class="literal">result</span>

<span class="comment"># 分析分割线标记 --</span>
<span class="keyword">if</span> len(input) &gt; <span class="number">2</span> <span class="keyword">and</span> all_same(input[:-<span class="number">1</span>], '-') <span class="keyword">and</span> input[-<span class="number">1</span>] == '\n':
    <span class="literal">result</span> = <span class="string">"&lt;hr&gt;"</span>
    <span class="keyword">return</span> <span class="literal">result</span>

<span class="comment"># 解析无序列表</span>
unorderd = ['+', '-']
<span class="keyword">if</span> <span class="literal">result</span> != <span class="string">""</span> <span class="keyword">and</span> <span class="literal">result</span>[<span class="number">0</span>] <span class="keyword">in</span> unorderd :
    <span class="literal">result</span> = handleUnorderd(<span class="literal">result</span>)
    is_normal = <span class="type">False</span>

f = input[<span class="number">0</span>]
count = <span class="number">0</span>
sys_q = <span class="type">False</span>
<span class="keyword">while</span> f == '&gt;':
    count += <span class="number">1</span>
    f = input[count]
    sys_q = <span class="type">True</span>
<span class="comment">#&lt;b&gt;是粗体</span>
<span class="keyword">if</span> sys_q:
    <span class="literal">result</span> = <span class="string">"&lt;blockquote style=\"color:#8fbc8f\"&gt; "</span>*count + <span class="string">"&lt;b&gt;"</span> + input[count:] + <span class="string">"&lt;/b&gt;"</span> + <span class="string">"&lt;/blockquote&gt;"</span>*count
    is_normal = <span class="type">False</span>

<span class="comment"># 处理特殊标记，比如 **, *</span>
<span class="literal">result</span> = tokenHandler(<span class="literal">result</span>)

<span class="comment"># 解析链接</span>
<span class="literal">result</span> = link_image(<span class="literal">result</span>)

<span class="comment">#空行换行</span>
pa = re.compile(r'^(\s)*$')
a = pa.match(input)
<span class="keyword">if</span> input[-<span class="number">1</span>] == <span class="string">"\n"</span> <span class="keyword">and</span> is_normal == <span class="type">True</span> <span class="keyword">and</span> <span class="keyword">not</span> a :
    <span class="literal">result</span>+=<span class="string">"&lt;br /&gt;"</span>

<span class="keyword">return</span> <span class="literal">result</span> 
</code></pre><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">通俗易懂的说，这个函数输入一行文本，通过 python 中的 re 库进行正则匹配 markdown语法，然后在文本中添加对应的 HTML 标签，然后返回处理好的行</span><br><span class="line"></span><br><span class="line">下面将列出转换函数的辅助函数。</span><br><span class="line"><span class="preprocessor">####<span class="number">5.1</span> 处理文本块</span></span><br></pre></td></tr></table></figure>
<p>def test_state(input):<br>    global orderList_state, block_state, is_code<br>    Code_List = [“python\n”, “c++\n”, “c\n”]</p>
<pre><code><span class="literal">result</span> = input

<span class="comment"># 构建正则表达式规则</span>
<span class="comment"># 匹配块标识</span>
pattern = re.compile(r'&lt;!--￼<span class="number">17</span>--&gt;
</code></pre><p>这个函数能处理代码块和特殊代码块(三个点后加语言)，和有序列表和无序列表</p>
<p>然而在特殊代码块周围加上\<code>\</code>后好像显示并没有什么区别，所以没有算在支持的语法中。</p>
<p>####5.2 链接处理函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">link_image</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="comment"># 超链接</span></span><br><span class="line">    <span class="comment"># pattern = re.compile(r'\\\[(.*)\]\((.*)\)')</span></span><br><span class="line">    pattern = re.compile(<span class="string">r'\[(.*)\]\((.*)\)'</span>)</span><br><span class="line">    match = pattern.finditer(s)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> match:</span><br><span class="line">        <span class="keyword">if</span> a:</span><br><span class="line">            text, url = a.group(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">            <span class="comment">#左闭右开的区间</span></span><br><span class="line">            x, y = a.span()</span><br><span class="line">            s = s[:x] + <span class="string">"&lt;a href="</span> + url + <span class="string">" target=\"_blank\"&gt;"</span> + text + <span class="string">"&lt;/a&gt;"</span> + s[y:]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>
<p>为了处理方便（偏移量没处理好），这个函数只能匹配一行中的第一个链接</p>
<p>####5.3 处理加粗、斜体标识<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tokenHandler</span><span class="params">(s)</span>:</span></span><br><span class="line">    l = [<span class="string">'b'</span>, <span class="string">'i'</span>]</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">'**'</span>, <span class="string">'*'</span>]:</span><br><span class="line">        pattern = re.compile(tokenTemplate(s,i))</span><br><span class="line">        match = pattern.finditer(s)</span><br><span class="line">        k = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> match:</span><br><span class="line">            <span class="keyword">if</span> a:</span><br><span class="line">                content = a.group(<span class="number">1</span>)</span><br><span class="line">                x,y = a.span()</span><br><span class="line">                <span class="comment"># &lt;b&gt;&lt;/b&gt;为7个字符 当*时，添加一次字符穿边长(7-2=5)个单位，当**时，增加(7-4=3）个单位</span></span><br><span class="line">                c = <span class="number">3</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="string">'*'</span>:</span><br><span class="line">                    c = <span class="number">5</span></span><br><span class="line">                s = s[:x+c*k] + <span class="string">"&lt;"</span> + l[j] + <span class="string">"&gt;"</span> + content + <span class="string">"&lt;/"</span> + l[j] + <span class="string">"&gt;"</span> + s[y+c*k:]</span><br><span class="line">                k += <span class="number">1</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure></p>
<p>这个处理比较简单，偏移量能算出来，一行能匹配多个加粗、斜体。</p>
<h4 id="5-4_加粗、斜体辅助函数">5.4 加粗、斜体辅助函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tokenTemplate</span><span class="params">(s, match)</span>:</span></span><br><span class="line">    pattern = <span class="string">""</span></span><br><span class="line">    <span class="keyword">if</span> match == <span class="string">'*'</span>:</span><br><span class="line">        pattern = <span class="string">"\*([^\*]*)\*"</span></span><br><span class="line">    <span class="keyword">if</span> match == <span class="string">'**'</span>:</span><br><span class="line">        pattern = <span class="string">"\*\*([^\*\*]*)\*\*"</span></span><br><span class="line">    <span class="keyword">return</span> pattern</span><br></pre></td></tr></table></figure>
<p>判断具体是加粗还是斜体，返回正则匹配式</p>
<p>####5.5 两个处理函数和一个简单的判断函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#　判断 lst 是否全由字符 sym 构成　</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">all_same</span><span class="params">(lst, sym)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">not</span> lst <span class="keyword">or</span> sym * len(lst) == lst</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理标题</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handleTitle</span><span class="params">(s, n)</span>:</span></span><br><span class="line">    temp = <span class="string">"&lt;h"</span> + repr(n) + <span class="string">"&gt;"</span> + s[n:] + <span class="string">"&lt;/h"</span> + repr(n) + <span class="string">"&gt;"</span></span><br><span class="line">    <span class="keyword">return</span> temp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理无序列表</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handleUnorderd</span><span class="params">(s)</span>:</span></span><br><span class="line">    s = <span class="string">"&lt;ul&gt;&lt;li&gt;"</span> + s[<span class="number">1</span>:]</span><br><span class="line">    s += <span class="string">"&lt;/li&gt;&lt;/ul&gt;"</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>
<p>##三. 其他说明<br>我将会在压缩包内放入示例文件（其实就是本文件支持的语法那一部分），以及其生成的 HTML 文件 和 PDF 文件.<br><img src="http://oj8wl05o7.bkt.clouddn.com/1.png" alt=""><br><img src="http://oj8wl05o7.bkt.clouddn.com/2.png" alt=""></p>
<p>##四. 自评分数<br><strong>优秀</strong></p>
<p>##五. 评价理由以及心得体会<br>这次大作业的代码框架来自实验楼的一个课程，我在半个月前就开始看这份代码，虽然曾经使用过 markdown (大一上时搭建过Hexo，一个轻量的静态博客，文章用 markdown来写，顺便贴上自己的博客地址 <a href="civinx.com">cinvx.com</a>)，知道其常用的一些语法，然而并看不懂这个解释器，主要是没有学习过正则表达式以及HTML语言，所以也无法理解代码的大思路。</p>
<p>为此我参加了计蒜课的python程序设计基础，并学习了其中的正则表达式专题，对我快速理解正则表达式和 re 库的使用提供了很大的帮助。以及普及了python语言的一些规范，包括命名规范和编程风格。</p>
<p><img src="http://oj8wl05o7.bkt.clouddn.com/3.png" alt=""></p>
<p>在学习的正则表达式后，整个代码就比较容易看懂了，大思路就是按行处理文本，通过正则匹配 markdown 语法，添加对应的 HTML 标签，写到目标文件里。至于如何在命令行运行和生成 PDF 文件，这些都可以通过库来帮助我实现，比如 wkhtmltopdf 能将 HTML 转成 PDF，以及 docopt 能方便地实现命令行程序。这个理解的过程大概花了我断断续续的一周和元旦完整的一天，然后花了一天时间对于需要的功能重写该代码。</p>
<p>整个大作业过程其实Python的语法是最简单的部分，难点是正则表达式的使用和学习一些 HTML 标签，以及库的使用。得意于这些难点，我也入门了这些难点，这些每一个第一步都是进步。这次 python 公选课给我的帮助还是非常大的。</p>
<p>根据我学习这门课程所花的精力和时间，以及学习的成果，我给自己的评价为 <strong>优秀</strong>。</p>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="Python3实现简易的markdown解释器">Python3实现简易的markdown解释器</h4>]]>
    
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[ACM实验室招新启事]]></title>
    <link href="http://yoursite.com/2016/09/21/ACM2016/"/>
    <id>http://yoursite.com/2016/09/21/ACM2016/</id>
    <published>2016-09-21T15:59:59.000Z</published>
    <updated>2016-09-22T01:21:22.000Z</updated>
    <content type="html"><![CDATA[<h4 id="小鲜肉们看这里！">小鲜肉们看这里！</h4><a id="more"></a>
<hr>
<p>各位2016级新童鞋：  </p>
<ul>
<li>你是否想在大学发现一个更精彩的新世界？</li>
<li>你是否对自己的天赋充满信心？（尤其是逻辑能力或数学思维）</li>
<li>你是否想体验最极致的编程乐趣？</li>
<li><p>你是否想找一群志(chou)同(wei)道(xiang)合(tou)的朋友一起奋斗？  </p>
<p>  

</p><p><strong>那么，来加入城院的ACM实验室吧!</strong></p>
</li>
</ul>
<p></p><p>（招收不限于计算分院，如果你身边有这样的朋友，也请你传递这个信息～）</p><p></p>
<hr>
<h4 id="我们对新成员的要求：">我们对新成员的要求：</h4><ul>
<li><p>人品过硬，不弄虚作假，要尊重老师 </p><p> </p></li>
<li><p>性格要好，和其他成员能融洽相处。</p><p>  </p></li>
<li><p>愿意无条件服从集训队安排的训练、组队、参赛以及其他统一的活动。</p><p>  </p></li>
<li><p>意志坚定，切忌一日曝、十日寒。愿意长期付出时间，而不是三心二意。</p><p></p></li>
</ul>
<hr>
<h4 id="注意事项：">注意事项：</h4><ul>
<li><p></p><p>如果你对ACM还不是很了解，请戳这个链接<a href="http://fateud.com/acm/" target="_blank" rel="external">城院ACM-ICPC竞赛简章</a>。  </p><p></p>
</li>
<li><p></p><p>对了，我们会在十二月中旬左右举办面向16级新生的程序设计竞赛（新生选拔赛）。</p>
<p>届时，我们会选择排名较前的部分同学，优先入驻实验室熟悉环境。  </p>
<p>为此，我们精心准备了一套对编程零基础的同学较为友好的题库，<br><a href="http://acm.zucc.edu.cn/JudgeOnline/diycontest.php?cid=1157" target="_blank" rel="external">http://acm.zucc.edu.cn/JudgeOnline/diycontest.php?cid=1157</a>  </p>
<p>欢迎同学们来练习。  </p>
</li>
<li><p></p><p>该训练题集也将纳入我们选拔新同学的参考范围，也就是说，  </p>
<p>即使你在新生赛中发挥不是特别出色，我们也会根据你训练题的出题数放低要求。</p>
<p>(请不要抄袭代码)</p><p></p>
</li>
<li><p></p><p>acm.zucc.edu.cn是我们本校的online judge，提供在线判题、比赛的功能。 </p>
<p>注册时请以学号为账号，姓名为昵称。</p><p></p>
</li>
</ul>
<hr>
<h4 id="联系方式：">联系方式：</h4><ul>
<li><p>QQ群号：578574227（2016 ACM/ICPC 新生群）</p><p></p></li>
<li><p>邮箱：admin@fateud.com（赵炎）、civin1128@gmail.com（陈哲凡）</p><p></p></li>
</ul>
<hr>
<h4 id="其他：">其他：</h4><ul>
<li><p>如果在刷题的过程中遇到困难，你可以在Web Board中发帖、或在ACM新生群求助，我们会及时回复。</p><p></p></li>
</ul>
<hr>
<p>  


</p><h6 align="right">浙江大学城市学院 - ACM实验室</h6>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="小鲜肉们看这里！">小鲜肉们看这里！</h4>]]>
    
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[杂碎]]></title>
    <link href="http://yoursite.com/2015/11/06/%E6%9D%82%E7%A2%8E/"/>
    <id>http://yoursite.com/2015/11/06/杂碎/</id>
    <published>2015-11-06T07:11:51.000Z</published>
    <updated>2016-04-24T01:12:58.000Z</updated>
    <content type="html"><![CDATA[<p></p><p>这里是我每日的杂碎。<br><a id="more"></a></p>
<hr>
<ul>
<li><p>差不多一个月了，经常睡到九十点才起。<br></p><p>再晚起是傻逼。<br></p><p>-2015.11.6</p></li>
</ul>
<hr>
<ul>
<li><p>道不同，不相谋、不足与争。<br></p><p>-2015.11.7</p></li>
</ul>
<hr>
<ul>
<li><p><em>WA的意思是，在W之后一定会A的。</em>—今日最暖</p></li>
<li><p>大头感冒了，好想快点飞到南昌去。<br></p><p>-2015.11.8</p></li>
</ul>
<hr>
<ul>
<li><p>我看着遍地的红色快递，好像看着一个时代。</p></li>
<li><p>期中考，最快的人十五分钟，我花了三十五钟，大崩。<br></p><p>-2015.11.13</p></li>
</ul>
<hr>
<ul>
<li><p>底子太差，恶补数论。<br></p><p>-2015.11.15</p></li>
</ul>
<hr>
<ul>
<li><em><p>Euler函数表达通式：euler(x)=x(1-1/p1)(1-1/p2)(1-1/p3)(1-1/p4)…(1-1/pn),其中p1,p2……pn为x的所有素因数，x是不为0的整数。euler(1)=1（唯一和1互质的数就是1本身）。</p></em><br><p>-2015.11.19</p></li>
</ul>
<hr>
<ul>
<li><em><p></p></em>n 个不同元素的错排种数<br>f(n) = (n-1)[f(n-2)+f(n-1)] (n&gt;2)。<br><p>-2015.12.19</p></li>
</ul>
<hr>
<ul>
<li><p>不被虐怎能变强？痛定思痛。<br></p><p>I will be a better me!<br></p><p>-2015.12.22</p></li>
</ul>
<hr>
<ul>
<li><p>文明5这个东西，赛吸毒啊！<br></p><p>-2016.1.31</p></li>
</ul>
<hr>
<ul>
<li><p>事实上，我们所在的这个世界，遍地都是唆麻，吸食它们不仅不是不道德的，更是自然的。有谁不乐意堕入到幸福乡去享乐几分钟呢？不安乐至死，才是要努力的事。<br></p><p>-2016.4.21<hr>
</p></li>
<li><p>这次省赛折戟沉沙，可说是砰得一下打醒了我的脑袋。且批评自己几点——过水题算不了什么本事，遇到难啃的题，巴望着队友做出来，连本事都不算！从新生赛、校赛、浙大赛，前二者不过是手速快A水题取胜，后者却更是躺赢，丝毫无贡献可言。好，bb完了，学习去了。<br></p><p>-2016.4.24</p></li>
</ul>
<hr>
]]></content>
    <summary type="html">
    <![CDATA[<p><p>这里是我每日的杂碎。<br>]]>
    
    </summary>
    
  </entry>
  
</feed>
